<%- include('./partials/header') %> <%- include('./partials/navbar') %>

<div class="mt-10">
  <div class="max-w-2xl mx-auto">
    <!-- profile card -->

    <div
      class="flex flex-col items-center mx-auto bg-zinc-800 py-4 border rounded-lg border-orange-400 shadow-inner shadow-orange-500"
    >
      <div class="relative w-32 h-32 mb-4">
        <a href="<%=user.profilePic%>">
          <img
            src="<%=user.profilePic%>"
            class="w-32 h-32 object-cover rounded-full border-4 border-red-400"
          />
        </a>

        <button
          id="inputButton"
          type="button"
          class="absolute top-20 -right-1 bg-white rounded-full p-2 shadow-md"
        >
          ✏️
        </button>
      </div>
      <!-- user details form -->
      <div class="mt-4">
        <form
          action="profile/uploadImage"
          method="post"
          enctype="multipart/form-data"
          id="profileForm"
        >
          <input
            type="file"
            name="profilePic"
            class="form-input"
            id="fileInput"
            hidden
          />
        </form>
        <form
          class="flex flex-col gap-3"
          action="/profile/update"
          method="post"
        >
          <div class="form-group">
            <label for="username">Username</label>
            <input
              type="text"
              name="username"
              class="form-input"
              value="<%=user.username%>"
            />
          </div>

          <div class="form-group">
            <label for="name">Name</label>
            <input
              type="text"
              name="name"
              class="form-input"
              value="<%=user.name%>"
            />
          </div>
          <div class="form-group">
            <label for="email">Email</label>
            <input
              type="email"
              name="email"
              class="form-input"
              value="<%=user.email%>"
            />
          </div>
          <div class="form-group">
            <label for="username">Age</label>
            <input
              type="number"
              name="age"
              class="form-input"
              value="<%=user.age%>"
            />
          </div>
          <div class="flex justify-center">
            <input
              type="submit"
              value="Submit"
              class="bg-orange-500 max-w-20 rounded px-2 mt-2 hover:opacity-55"
            />
          </div>
        </form>
      </div>
    </div>
  </div>
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const button = document.querySelector("#inputButton");
      const fileInput = document.querySelector("#fileInput");
      const profileForm = document.querySelector("#profileForm");

      //when pen is clicked , open hiiden file input
      button.addEventListener("click", () => {
        fileInput.click();
      });

      //when u upload file or input changes trigger this
      fileInput.addEventListener("change", () => {
        profileForm.submit();
      });
    });
  </script>
</div>

<%- include ('./partials/footer') %>
